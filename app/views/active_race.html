<div class="container krend-page">
	<div class="krend row">
		<div class="col-md-9 col-xs-11">
			<tabset>
				<tab heading="Active Race">
					<br />
					<div ng-switch on="!!activeRace">
						<div ng-switch-when="false">
							Select active race from Available Races tab
						</div>
						<div ng-switch-default>
							raceId: {{ activeRace.raceId }} Løb: {{ activeRace.race.name }} {{ activeRace.race.location }} {{ activeRace.race.date }}
							<br />
							<form class="navbar-form" ng-submit="addParticipantToRace()" ng-show="signedIn()">
								<div class="form-group">
									<input type="text" class="form-control" placeholder="Participant" ng-model="participant.name" typeahead="n as n.name for n in getParticipantNames($viewValue) | filter:$viewValue" typeahead-loading="loadingParticipants">
								</div>
								<button type="submit" class="btn btn-default">Add Participant</button>
							</form>
							<div ng-repeat="(participantId, participant) in participantsInRace">
								<div class="info" ng-show="signedIn()">
									{{ $index + 1 }}, 
									<a href="#" editable-text="participant.name" onaftersave="updateParticipant(participantId, participant, activeRace.raceId)">{{ participant.name }}</a>
									<a href="#" editable-text="participant.born" onaftersave="updateParticipant(participantId, participant, activeRace.raceId)">{{ participant.born }}</a>
									<a href="#" editable-text="participant.club" e-typeahead="club for club in getClubNames($viewValue) | filter:$viewValue" onaftersave="updateParticipant(participantId, participant, activeRace.raceId)">{{ participant.club }}</a>
									<a ng-click="deleteParticipant(participantId, activeRace.raceId)" ng-show="signedIn() && participant.owner === currentUser.username">(delete)</a>
								</div>
							</div>
							<div class="info" ng-hide="signedIn()">
								<div ng-repeat="(participantId, participant) in participantsInRace">
									{{ $index + 1 }},
									<a href="#/login">{{ participant.name }}, født {{ participant.born }}</a>
								</div>
							</div>
						</div>
					</div>
				</tab>
				<tab heading="Available Races">
					<div ng-repeat="(raceId, race) in races">
						<div class="info form-group" ng-show="signedIn()">
							<br />
							{{ race.name }}
							{{ race.date | date: "dd-MM-yyyy" }}
							{{ race.location }}
							<button ng-click="setActiveRace(raceId, race)" class="btn btn-default">Select Race</button>
						</div>
						<div class="info form-group" ng-hide="signedIn()">
							<br />
							<a href="#/login">{{ race.name }}</a>
							<a href="#/login">{{ race.date | date: "dd-MM-yyyy" }}</a>
							<a href="#/login">{{ race.location }}</a>
						</div>
					</div>
				</tab>
				<tab ng-repeat="tab in tabs" heading="{{ tab.title }}" active="tab.active" disabled="tab.disabled">
					{{ tab.content }}
				</tab>
				<tab select="alertMe()">
					<tab-heading>
						<i class="glyphicon glyphicon-bell"></i> Alert!
					</tab-heading>
					I've got an HTML heading, and a select callback. Pretty cool!
				</tab>
			</tabset>
		</div>
	</div>
</div>
